<?xml version="1.0"?>
<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
"http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
<hibernate-mapping>

	<query name="Activity.findByCode">
		FROM Activity as activity
		WHERE code = :code
	</query>
	
	<query name="Activity.findByUser"> 
 	    SELECT activity
		FROM Activity as activity
		WHERE assignedUser = :assignedUser
	</query>
	
	<query name="Activity.findByProject">
 	    SELECT activity
		FROM Activity as activity
		WHERE project = :project
	</query>
	
	<query name="Activity.findByProjectAndDateRange">
 	    <![CDATA[	
		FROM Activity activity
		WHERE activity.active is true AND 
			  activity.project.active is true AND
			  activity.project =:project AND 
			  (activity.dateStart IS NULL OR activity.dateStart <= :dateEnd) AND
			  (activity.dateEnd IS NULL or activity.dateEnd >= :dateStart)
    		 ]]>
	</query>

	<query name="Activity.findActivitiessForUserInRange">
    <![CDATA[	
		FROM Activity activity
		WHERE activity.active is true AND
			  activity.project.active is true AND
			  activity.project.customer.active is true AND 
			  activity.assignedUser.userId = :userId AND
			  (activity.dateStart IS NULL OR activity.dateStart <= :dateEnd) AND
			  (activity.dateEnd IS NULL or activity.dateEnd >= :dateStart)
    		 ]]>
	</query>

	<query name="Activity.findActivitiesForCustomers">
    <![CDATA[	
		FROM Activity activity
		WHERE activity.active is true AND 
			  activity.project.active is true AND
			  activity.project.customer.active is true AND 
			  activity.project.customer in (:customers)
    		 ]]>
	</query>
	
	<query name="Activity.findActivitiesForCustomersAndDateRange">
    <![CDATA[	
		FROM Activity activity
		WHERE activity.active is true AND 
			  activity.project.active is true AND
			  activity.project.customer.active is true AND 
			  activity.project.customer in (:customers) AND
			  (activity.dateStart IS NULL OR activity.dateStart <= :dateEnd) AND
			  (activity.dateEnd IS NULL or activity.dateEnd >= :dateStart)
    		 ]]>
	</query>	
</hibernate-mapping>